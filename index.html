<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Grupos de Materias</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <header>
      <h1>Grupos de Materias</h1>
      <p>Lista de profesores y enlaces a grupos de WhatsApp</p>
      <input
        type="text"
        id="searchBar"
        placeholder="Buscar materia o profesor..."
      />
    </header>

    <main id="content"></main>

    <footer>
      <p><strong>Proyecto estudiantil sin afiliación oficial.</strong></p>
      <p>
        Este sitio web no pertenece ni está respaldado por el Tecnológico
        Nacional de México (TecNM) ni por ninguna de sus instituciones. No
        representa oficialmente a profesores, grupos o programas académicos.
      </p>
      <p>
        La información publicada es con fines de apoyo entre estudiantes y puede
        no estar actualizada o ser precisa. El uso de este sitio es bajo tu
        propio riesgo.
      </p>
      <p>
        Los enlaces a grupos de WhatsApp son proporcionados por la comunidad
        estudiantil y no son administrados por este sitio. Úsalos bajo tu propio
        criterio.
      </p>
    </footer>

    <script>
      fetch("data.json?v=" + Date.now())
        .then((res) => res.json())
        .then((data) => renderData(data));

      function renderData(data) {
        const content = document.getElementById("content");
        content.innerHTML = "";

        Object.keys(data).forEach((categoria) => {
          const section = document.createElement("section");
          const title = document.createElement("h2");
          title.textContent = categoria;
          section.appendChild(title);

          const ul = document.createElement("ul");
          data[categoria].forEach((prof) => {
            const li = document.createElement("li");
            const span = document.createElement("span");
            span.textContent = prof.name;
            li.appendChild(span);

            let btn;
            if (prof.url) {
              btn = document.createElement("a");
              btn.href = prof.url;
              btn.target = "_blank";
              btn.className = "btn";
              btn.textContent = "WhatsApp";
            } else {
              btn = document.createElement("span");
              btn.className = "btn disabled";
              btn.textContent = "No disponible";
            }
            li.appendChild(btn);

            ul.appendChild(li);
          });

          section.appendChild(ul);
          content.appendChild(section);
        });
      }

      document
        .getElementById("searchBar")
        .addEventListener("keyup", function () {
          const query = this.value.toLowerCase();
          document.querySelectorAll("section").forEach((section) => {
            const text = section.innerText.toLowerCase();
            section.style.display = text.includes(query) ? "block" : "none";
          });
        });
    </script>
  </body>
</html>
